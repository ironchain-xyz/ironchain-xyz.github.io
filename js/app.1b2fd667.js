(function(){var e={5602:function(e,t,n){"use strict";n.d(t,{T:function(){return o},_:function(){return r}});const r="http://localhost:3000/",o=r},2776:function(e,t,n){"use strict";var r=n(9242),o=n(8387),a=n(3396);function s(e,t){const n=(0,a.up)("router-view");return(0,a.wg)(),(0,a.j4)(n,{key:e.$route.name})}var c=n(89);const l={},i=(0,c.Z)(l,[["render",s]]);var u=i,d=n(4535),f=n(3211);n(2467);const p=(0,r.ri)(u);p.use(f.ZP),p.use(o.h,o.Jy),p.use(d.Z).mount("#app")},4535:function(e,t,n){"use strict";n.d(t,{Z:function(){return bn}});var r=n(678),o=n(3396);function a(e,t,n,r,a,s){const c=(0,o.up)("Home");return(0,o.wg)(),(0,o.j4)(c)}var s=n(6520);const c={class:"content"},l={key:0,style:{"padding-bottom":"100px"}};function i(e,t,n,r,a,s){const i=(0,o.up)("Navigation"),u=(0,o.up)("CreatedRecords"),d=(0,o.up)("a-row");return(0,o.wg)(),(0,o.iD)("div",c,[(0,o.Wm)(i),e.authenticated?((0,o.wg)(),(0,o.iD)("div",l,[(0,o.Wm)(d,{justify:"center"},{default:(0,o.w5)((()=>[(0,o.Wm)(u)])),_:1})])):(0,o.kq)("",!0)])}var u=n(4870),d=n(6949);const f=e=>((0,o.dD)("data-v-4b8fa2ec"),e=e(),(0,o.Cn)(),e),p=f((()=>(0,o._)("img",{alt:"Vue logo",src:d,style:{width:"50px",height:"50px"}},null,-1))),m=f((()=>(0,o._)("a",{href:"/"},"Discover",-1))),v=f((()=>(0,o._)("a",{href:"/home"},"Home",-1))),g=f((()=>(0,o._)("a",{href:"/collections"},"Collections",-1))),w=f((()=>(0,o._)("a",{href:"/profile"},"Setting",-1))),h=f((()=>(0,o._)("span",null,"Create Record",-1))),y={href:"/record/new"};function _(e,t,n,r,a,s){const c=(0,o.up)("a-col"),l=(0,o.up)("home-outlined"),i=(0,o.up)("a-menu-item"),u=(0,o.up)("user-outlined"),d=(0,o.up)("heart-outlined"),f=(0,o.up)("setting-outlined"),_=(0,o.up)("a-menu"),k=(0,o.up)("PlusOutlined"),W=(0,o.up)("a-button"),b=(0,o.up)("a-tooltip"),C=(0,o.up)("a-row"),j=(0,o.up)("a-affix");return(0,o.wg)(),(0,o.j4)(j,{"offset-top":e.top},{default:(0,o.w5)((()=>[(0,o.Wm)(C,{justify:"center"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{span:2,class:"nav-item"},{default:(0,o.w5)((()=>[p])),_:1}),(0,o.Wm)(c,{class:"nav-item"},{default:(0,o.w5)((()=>[(0,o.Wm)(_,{mode:"horizontal",class:"menuItem"},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{key:"discover"},{icon:(0,o.w5)((()=>[(0,o.Wm)(l)])),default:(0,o.w5)((()=>[m])),_:1}),(0,o.Wm)(i,{key:"home"},{icon:(0,o.w5)((()=>[(0,o.Wm)(u)])),default:(0,o.w5)((()=>[v])),_:1}),(0,o.Wm)(i,{key:"collections"},{icon:(0,o.w5)((()=>[(0,o.Wm)(d)])),default:(0,o.w5)((()=>[g])),_:1}),(0,o.Wm)(i,{key:"profile"},{icon:(0,o.w5)((()=>[(0,o.Wm)(f)])),default:(0,o.w5)((()=>[w])),_:1})])),_:1})])),_:1}),(0,o.Wm)(c,{span:2,class:"nav-item",style:{"margin-top":"20px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(b,{placement:"right"},{title:(0,o.w5)((()=>[h])),default:(0,o.w5)((()=>[(0,o._)("a",y,[(0,o.Wm)(W,{type:"primary",shape:"circle"},{icon:(0,o.w5)((()=>[(0,o.Wm)(k)])),_:1})])])),_:1})])),_:1})])),_:1})])),_:1},8,["offset-top"])}var k=n(8896),W=n(5050),b=n(3300),C=n(7098),j=n(7081),x=n(8387),R=n(6678),Z=n(9248),T=(0,o.aZ)({components:{UserOutlined:k.Z,HomeOutlined:W.Z,HeartOutlined:b.Z,SettingOutlined:C.Z,PlusOutlined:j.Z},props:{tabKey:Z.Z_},setup(){const e=(0,x.oR)();return{onLogout:()=>(0,R.kS)(e)}}}),z=n(89);const D=(0,z.Z)(T,[["render",_],["__scopeId","data-v-4b8fa2ec"]]);var U=D,O=n(2268);function P(e,t,n,r,a,s){const c=(0,o.up)("CreatedRecord"),l=(0,o.up)("a-row"),i=(0,o.up)("a-spin");return(0,o.wg)(),(0,o.iD)(o.HY,null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.records,(t=>((0,o.wg)(),(0,o.j4)(l,{key:t.hash,type:"flex",justify:"center",class:"preview"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{record:t,onToggleCollection:e.toggleCollection},null,8,["record","onToggleCollection"])])),_:2},1024)))),128)),(0,o.Wm)(l,null,{default:(0,o.w5)((()=>[e.loading?((0,o.wg)(),(0,o.j4)(i,{key:0})):(0,o.kq)("",!0)])),_:1}),e.errMsg?((0,o.wg)(),(0,o.j4)(l,{key:0,style:{"margin-top":"100px"}},{default:(0,o.w5)((()=>[(0,o._)("span",null,(0,O.zw)(e.errMsg),1)])),_:1})):(0,o.kq)("",!0)],64)}var H=n(9553);const S=["href"];function q(e,t,n,r,a,s){const c=(0,o.up)("a-avatar"),l=(0,o.up)("a-row"),i=(0,o.up)("a-col"),u=(0,o.up)("HeartOutlined"),d=(0,o.up)("HeartTwoTone"),f=(0,o.up)("a-button"),p=(0,o.up)("Evidences"),m=(0,o.up)("References"),v=(0,o.up)("a-divider");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(l,{class:"container"},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{span:4},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{size:50,class:"avatar",shape:"square"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,O.zw)(e.record.creator.username.substring(0,1).toUpperCase()),1)])),_:1}),(0,o.Wm)(l,{type:"flex",justify:"center"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,O.zw)(e.record.creator.username),1)])),_:1})])),_:1}),(0,o.Wm)(i,{span:20},{default:(0,o.w5)((()=>[(0,o.Wm)(l,{justify:"space-between"},{default:(0,o.w5)((()=>[(0,o.Wm)(i,null,{default:(0,o.w5)((()=>[(0,o._)("a",{href:e.recordUrl},[(0,o._)("span",null,(0,O.zw)(e.record.description),1)],8,S)])),_:1}),(0,o.Wm)(i,null,{default:(0,o.w5)((()=>[(0,o.Wm)(f,{type:"text",onClick:e.toggleCollection,style:{padding:"0px"}},{icon:(0,o.w5)((()=>[e.isCollected?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(u,{key:0})),e.isCollected?((0,o.wg)(),(0,o.j4)(d,{key:1,twoToneColor:"#eb2f96"})):(0,o.kq)("",!0)])),default:(0,o.w5)((()=>[(0,o.Uk)(" "+(0,O.zw)(e.record.collectors.length),1)])),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.Wm)(l,null,{default:(0,o.w5)((()=>[(0,o.Wm)(p,{evidences:e.record.evidences},null,8,["evidences"])])),_:1}),(0,o.Wm)(m,{references:e.record.references},null,8,["references"]),(0,o.Wm)(l,{type:"flex",justify:"space-between",align:"middle",style:{"margin-top":"10px",color:"gray","font-size":"12px"}},{default:(0,o.w5)((()=>[(0,o.Uk)((0,O.zw)(e.formatDate(e.record.createdAt)),1)])),_:1})])),_:1})])),_:1}),(0,o.Wm)(v,{class:"container"})],64)}var F=n(6265),E=n.n(F),A=n(5602);function I(e,t){let n=!0;e.description||(t.description="Description cannot be empty",n=!1);for(const r in e.evidences||[]){const o=e.evidences[r];"error"==o.status&&(t.evidences="Please remove invalid files",n=!1),"uploading"==o.status&&(t.evidences="Please wait util all files uploaded",n=!1)}return{ok:n,alert:t}}async function Y(e,t){const n=A.T+"record/new";console.log(t);const r=await E().post(n,{description:t.description,evidences:t.evidences.map((e=>e.response)),references:t.references.map((e=>({hash:e.hash})))},{headers:(0,H.zl)(e)});return r.data}async function M(e,t){const n=A.T+"record/",r=await E().get(n,{headers:(0,H.zl)(e),params:{hash:t}});return r.data.references=r.data.reference,r.data}async function B(e,t){const n=A.T+"record/latest",r=await E().get(n,{headers:(0,H.zl)(e),params:t});return r.data.records.map((e=>({...e,references:e.reference})))}async function N(e,t){const n=A.T+"record/created",r=await E().get(n,{headers:(0,H.zl)(e),params:t});return r.data.records.map((e=>({...e,references:e.reference})))}async function K(e,t){const n=A.T+"record/collections",r=await E().get(n,{headers:(0,H.zl)(e),params:t});return r.data.records.map((e=>({...e.record,references:e.record.reference,collectedAt:e.updatedAt})))}async function G(e,t){const n=A.T+"record/addToCollection",r=await E().post(n,{hash:t},{headers:(0,H.zl)(e)});return r.data}async function L(e,t){const n=A.T+"record/removeFromCollection",r=await E().post(n,{hash:t},{headers:(0,H.zl)(e)});return r.data}const $=["src","alt"],J=["src"];function V(e,t,n,r,a,s){const c=(0,o.up)("a-row");return e.evidences.length>0?((0,o.wg)(),(0,o.j4)(c,{key:0,class:"evidenceWrapper",type:"flex"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.evidences,(t=>((0,o.wg)(),(0,o.iD)("div",{key:t.hash},["image"==e.fileType(t)?((0,o.wg)(),(0,o.iD)("img",{key:0,src:e.fileUrl(t),alt:t.hash,class:(0,O.C_)(e.thumbnail?"thumbnail":"origin")},null,10,$)):(0,o.kq)("",!0),"video"==e.fileType(t)?((0,o.wg)(),(0,o.iD)("video",{key:1,class:(0,O.C_)(e.thumbnail?"thumbnail":"origin"),controls:""},[(0,o._)("source",{src:e.fileUrl(t),type:"video/mp4"},null,8,J)],2)):(0,o.kq)("",!0)])))),128))])),_:1})):(0,o.kq)("",!0)}function Q(e){const t=new Date(e),n=Math.abs(Date.now()-t.valueOf());return n>864e5?"on "+t.toLocaleDateString("en-US"):n>36e5?Math.floor(n/36e5).toString()+" hours ago":n>6e4?Math.floor(n/6e4).toString()+" minutes ago":n>1e3?Math.floor(n/1e3).toString()+" seconds ago":"Just now"}function X(e){return e?e<1024?e.toFixed(1)+"B":e<1048576?(e/1024).toFixed(1).toString()+"KB":e<1073741824?(e/1048576).toFixed(1).toString()+"MB":"> 1GB":"Unknown Size"}var ee=(0,o.aZ)({props:{evidences:Object,thumbnail:Boolean},setup(){const e=e=>A._+"static/evidences/"+e.rawFile.hash,t=e=>"image/png"==e.mimeType||"image/jpeg"==e.mimeType||"image/jpg"==e.mimeType?"image":"video/mp4"==e.mimeType?"video":"file";return{fileUrl:e,formatFileSize:X,fileType:t}}});const te=(0,z.Z)(ee,[["render",V],["__scopeId","data-v-28e2ab00"]]);var ne=te;const re=["href"];function oe(e,t,n,r,a,s){const c=(0,o.up)("a-avatar"),l=(0,o.up)("a-row"),i=(0,o.up)("a-col"),u=(0,o.up)("Evidences"),d=(0,o.up)("InfoCircleOutlined"),f=(0,o.up)("a-button");return(0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.references,(e=>((0,o.wg)(),(0,o.j4)(l,{key:e.hash,class:"refWrapper",type:"flex",justify:"space-between",align:"middle"},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{span:4},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{size:30,class:"avatar",shape:"square"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,O.zw)(e.creator.username.substring(0,1).toUpperCase()),1)])),_:2},1024),(0,o.Wm)(l,{justify:"center"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,O.zw)(e.creator.username),1)])),_:2},1024)])),_:2},1024),(0,o.Wm)(i,{span:9},{default:(0,o.w5)((()=>[(0,o.Uk)((0,O.zw)(e.description.substring(0,100)),1)])),_:2},1024),(0,o.Wm)(i,{span:9},{default:(0,o.w5)((()=>[(0,o.Wm)(l,null,{default:(0,o.w5)((()=>[(0,o.Wm)(u,{evidences:e.evidences.slice(0,3),thumbnail:!0},null,8,["evidences"])])),_:2},1024)])),_:2},1024),(0,o.Wm)(i,{span:2},{default:(0,o.w5)((()=>[(0,o._)("a",{href:"/record/"+e.hash},[(0,o.Wm)(f,{type:"text"},{icon:(0,o.w5)((()=>[(0,o.Wm)(d)])),_:1})],8,re)])),_:2},1024)])),_:2},1024)))),128)}var ae=n(5953),se=(0,o.aZ)({components:{Evidences:ne,InfoCircleOutlined:ae.Z},props:{references:Object},setup(){const e=e=>A._+"static/evidences/"+e.rawFile.hash,t=e=>"image/png"==e.mimeType||"image/jpeg"==e.mimeType||"image/jpg"==e.mimeType?"image":"video/mp4"==e.mimeType?"video":"file",n=e=>{const t=e.rawFile.size;return t?t<1024?t.toFixed(1)+"B":t<1048576?(t/1024).toFixed(1).toString()+"KB":t<1073741824?(t/1048576).toFixed(1).toString()+"MB":"> 1GB":"Unknown Size"};return{shortDescription:H.Z8,fileUrl:e,fileType:t,calFileSize:n,formatDate:Q}}});const ce=(0,z.Z)(se,[["render",oe],["__scopeId","data-v-93892810"]]);var le=ce,ie=n(6146),ue=(0,o.aZ)({components:{Evidences:ne,References:le,HeartOutlined:b.Z,HeartTwoTone:ie.Z},props:{record:Object},setup(e,{emit:t}){const n=(0,x.oR)(),r=(0,o.Fl)((()=>"/record/"+e.record.hash)),a=(0,o.Fl)((()=>{const t=n.state.user.id;return e.record.collectors.some((e=>e.userId==t))})),s=()=>{a.value?L(n,e.record.hash).then((()=>{t("toggleCollection",{action:"remove",record:e.record.hash})})):G(n,e.record.hash).then((()=>{t("toggleCollection",{action:"add",record:e.record.hash})}))};return{formatDate:Q,recordUrl:r,toggleCollection:s,isCollected:a}}});const de=(0,z.Z)(ue,[["render",q],["__scopeId","data-v-6ca41ce0"]]);var fe=de,pe=(0,o.aZ)({components:{CreatedRecord:fe},setup(){const e=(0,x.oR)();let t=(0,u.iH)(!1),n=(0,u.iH)([]),r=(0,u.iH)("");const a=(0,u.qj)({limit:20,offset:0});(0,o.wF)((()=>{n.value=[],t.value=!0,N(e,a).then((e=>{e.forEach((e=>{n.value.push(e)})),a.limit+=e.length,e.length>0&&(a.startAt=a.startAt||e[0].createdAt)})).catch((e=>{r.value="Failed to fetch events from server, "+(0,H.nt)(e)})).finally((()=>{t.value=!1}))}));const s=t=>{const r=e.state.user.id;for(let e=0;e<n.value.length;e++)n.value[e].hash==t.record&&("remove"==t.action?n.value[e].collectors=n.value[e].collectors.filter((e=>e.userId!=r)):"add"==t.action&&n.value[e].collectors.push({userId:r}))};return{loading:t,errMsg:r,records:n,toggleCollection:s}}});const me=(0,z.Z)(pe,[["render",P],["__scopeId","data-v-629ee322"]]);var ve=me,ge=(0,o.aZ)({components:{Navigation:U,CreatedRecords:ve},setup(){const e=(0,x.oR)(),t=(0,u.iH)(!1);if((0,R.YR)(e))return t.value=!0,{authenticated:t}}});const we=(0,z.Z)(ge,[["render",i],["__scopeId","data-v-eb157a78"]]);var he=we,ye=function(e,t,n,r){var o,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(a<3?o(s):a>3?o(t,n,s):o(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s};let _e=class extends s.w3{};_e=ye([(0,s.Ei)({components:{Home:he}})],_e);var ke=_e;const We=(0,z.Z)(ke,[["render",a]]);var be=We;function Ce(e,t,n,r,a,s){const c=(0,o.up)("Discover");return(0,o.wg)(),(0,o.j4)(c)}const je={class:"content"},xe={key:0,style:{"padding-bottom":"100px"}};function Re(e,t,n,r,a,s){const c=(0,o.up)("Navigation"),l=(0,o.up)("DiscoverRecords");return(0,o.wg)(),(0,o.iD)("div",je,[(0,o.Wm)(c),e.authenticated?((0,o.wg)(),(0,o.iD)("div",xe,[(0,o.Wm)(l)])):(0,o.kq)("",!0)])}function Ze(e,t,n,r,a,s){const c=(0,o.up)("DiscoverRecord"),l=(0,o.up)("a-row"),i=(0,o.up)("a-spin");return(0,o.wg)(),(0,o.iD)(o.HY,null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.records,(t=>((0,o.wg)(),(0,o.j4)(l,{key:t.hash,type:"flex",justify:"center",class:"preview"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{record:t,onToggleCollection:e.toggleCollection},null,8,["record","onToggleCollection"])])),_:2},1024)))),128)),(0,o.Wm)(l,null,{default:(0,o.w5)((()=>[e.loading?((0,o.wg)(),(0,o.j4)(i,{key:0})):(0,o.kq)("",!0)])),_:1}),e.errMsg?((0,o.wg)(),(0,o.j4)(l,{key:0,style:{"margin-top":"100px"}},{default:(0,o.w5)((()=>[(0,o._)("span",null,(0,O.zw)(e.errMsg),1)])),_:1})):(0,o.kq)("",!0)],64)}const Te=["href"];function ze(e,t,n,r,a,s){const c=(0,o.up)("a-avatar"),l=(0,o.up)("a-row"),i=(0,o.up)("a-col"),u=(0,o.up)("HeartOutlined"),d=(0,o.up)("HeartTwoTone"),f=(0,o.up)("a-button"),p=(0,o.up)("Evidences"),m=(0,o.up)("References"),v=(0,o.up)("a-divider");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(l,{class:"container"},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{span:4},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{size:50,class:"avatar",shape:"square"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,O.zw)(e.record.creator.username.substring(0,1).toUpperCase()),1)])),_:1}),(0,o.Wm)(l,{type:"flex",justify:"center"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,O.zw)(e.record.creator.username),1)])),_:1})])),_:1}),(0,o.Wm)(i,{span:20},{default:(0,o.w5)((()=>[(0,o.Wm)(l,{justify:"space-between"},{default:(0,o.w5)((()=>[(0,o.Wm)(i,null,{default:(0,o.w5)((()=>[(0,o._)("a",{href:e.recordUrl},[(0,o._)("span",null,(0,O.zw)(e.record.description),1)],8,Te)])),_:1}),(0,o.Wm)(i,null,{default:(0,o.w5)((()=>[(0,o.Wm)(f,{type:"text",onClick:e.toggleCollection,style:{padding:"0px"}},{icon:(0,o.w5)((()=>[e.isCollected?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(u,{key:0})),e.isCollected?((0,o.wg)(),(0,o.j4)(d,{key:1,twoToneColor:"#eb2f96"})):(0,o.kq)("",!0)])),default:(0,o.w5)((()=>[(0,o.Uk)(" "+(0,O.zw)(e.record.collectors.length),1)])),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.Wm)(l,null,{default:(0,o.w5)((()=>[(0,o.Wm)(p,{evidences:e.record.evidences},null,8,["evidences"])])),_:1}),(0,o.Wm)(m,{references:e.record.references},null,8,["references"]),(0,o.Wm)(l,{type:"flex",justify:"space-between",align:"middle",style:{"margin-top":"10px",color:"gray","font-size":"12px"}},{default:(0,o.w5)((()=>[(0,o.Uk)((0,O.zw)(e.formatDate(e.record.createdAt)),1)])),_:1})])),_:1})])),_:1}),(0,o.Wm)(v,{class:"container"})],64)}var De=(0,o.aZ)({components:{Evidences:ne,References:le,HeartOutlined:b.Z,HeartTwoTone:ie.Z},props:{record:Object},setup(e,{emit:t}){const n=(0,x.oR)(),r=(0,o.Fl)((()=>"/record/"+e.record.hash)),a=(0,o.Fl)((()=>{const t=n.state.user.id;return e.record.collectors.some((e=>e.userId==t))})),s=()=>{a.value?L(n,e.record.hash).then((()=>{t("toggleCollection",{action:"remove",record:e.record.hash})})):G(n,e.record.hash).then((()=>{t("toggleCollection",{action:"add",record:e.record.hash})}))};return{formatDate:Q,recordUrl:r,toggleCollection:s,isCollected:a}}});const Ue=(0,z.Z)(De,[["render",ze],["__scopeId","data-v-01e9f623"]]);var Oe=Ue,Pe=(0,o.aZ)({components:{DiscoverRecord:Oe},setup(){const e=(0,x.oR)();let t=(0,u.iH)(!1),n=(0,u.iH)([]),r=(0,u.iH)("");const a=(0,u.qj)({limit:20,offset:0});(0,o.wF)((()=>{n.value=[],t.value=!0,B(e,a).then((e=>{e.forEach((e=>{n.value.push(e)})),a.limit+=e.length,e.length>0&&(a.startAt=a.startAt||e[0].createdAt)})).catch((e=>{r.value="Failed to fetch events from server, "+(0,H.nt)(e)})).finally((()=>{t.value=!1}))}));const s=t=>{const r=e.state.user.id;for(let e=0;e<n.value.length;e++)n.value[e].hash==t.record&&("remove"==t.action?n.value[e].collectors=n.value[e].collectors.filter((e=>e.userId!=r)):"add"==t.action&&n.value[e].collectors.push({userId:r}))};return{loading:t,errMsg:r,records:n,toggleCollection:s}}});const He=(0,z.Z)(Pe,[["render",Ze],["__scopeId","data-v-520c2ebc"]]);var Se=He,qe=(0,o.aZ)({components:{Navigation:U,DiscoverRecords:Se},setup(){const e=(0,x.oR)(),t=(0,u.iH)(!1);if((0,R.YR)(e))return t.value=!0,{authenticated:t}}});const Fe=(0,z.Z)(qe,[["render",Re],["__scopeId","data-v-1665853d"]]);var Ee=Fe,Ae=function(e,t,n,r){var o,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(a<3?o(s):a>3?o(t,n,s):o(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s};let Ie=class extends s.w3{};Ie=Ae([(0,s.Ei)({components:{Discover:Ee}})],Ie);var Ye=Ie;const Me=(0,z.Z)(Ye,[["render",Ce]]);var Be=Me;function Ne(e,t,n,r,a,s){const c=(0,o.up)("Profile");return(0,o.wg)(),(0,o.j4)(c)}const Ke={class:"content"},Ge={class:"field"},Le={class:"field",style:{"max-width":"200px","margin-left":"auto","margin-right":"auto"}},$e=(0,o.Uk)("Username"),Je={class:"field"},Ve=(0,o.Uk)("Email"),Qe={class:"field"},Xe=(0,o.Uk)("Invitation Codes"),et={class:"field"},tt=(0,o.Uk)(" Logout ");function nt(e,t,n,r,a,s){const c=(0,o.up)("Navigation"),l=(0,o.up)("a-alert"),i=(0,o.up)("a-typography-title"),u=(0,o.up)("a-typography-paragraph"),d=(0,o.up)("a-button");return(0,o.wg)(),(0,o.iD)("div",Ke,[(0,o.Wm)(c),(0,o._)("div",null,[(0,o._)("div",Ge,[e.alert?((0,o.wg)(),(0,o.j4)(l,{key:0,message:e.alert,type:"error"},null,8,["message"])):(0,o.kq)("",!0)]),(0,o._)("div",Le,[(0,o.Wm)(i,{level:4},{default:(0,o.w5)((()=>[$e])),_:1}),(0,o.Wm)(u,{content:e.username,"onUpdate:content":t[0]||(t[0]=t=>e.username=t),editable:{onEnd:e.onUsernameChange}},null,8,["content","editable"])]),(0,o._)("div",Je,[(0,o.Wm)(i,{level:4},{default:(0,o.w5)((()=>[Ve])),_:1}),(0,o.Wm)(u,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,O.zw)(e.email),1)])),_:1})]),(0,o._)("div",Qe,[(0,o.Wm)(i,{level:4},{default:(0,o.w5)((()=>[Xe])),_:1}),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.invitationCodes,(({code:e,used:t},n)=>((0,o.wg)(),(0,o.iD)("div",{key:n},[(0,o.Wm)(u,{class:(0,O.C_)({used:t,active:!t}),copyable:!t},{default:(0,o.w5)((()=>[(0,o.Uk)((0,O.zw)(e),1)])),_:2},1032,["class","copyable"])])))),128))]),(0,o._)("div",et,[(0,o.Wm)(d,{type:"primary",onClick:e.onLogout},{default:(0,o.w5)((()=>[tt])),_:1},8,["onClick"])])])])}var rt=n(6772),ot=(0,o.aZ)({components:{Navigation:U},setup(){const e=(0,x.oR)();let t=(0,u.iH)(""),n=(0,u.qj)([]);(0,o.wF)((()=>{(0,rt.x6)(e).then((e=>{e.message?t.value=e.message:e.codes&&e.codes.length>0&&e.codes.forEach((e=>{n.push(e)}))}))}));const r=(0,u.iH)(e.state.profile.username),a=()=>{(0,rt._S)(e,r.value).then((()=>{r.value=e.state.profile.username}))},s=(0,o.Fl)((()=>e.state.user.email));return{email:s,username:r,alert:t,invitationCodes:n,onUsernameChange:a,onLogout:()=>(0,R.kS)(e)}}});const at=(0,z.Z)(ot,[["render",nt],["__scopeId","data-v-1f27de29"]]);var st=at,ct=function(e,t,n,r){var o,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(a<3?o(s):a>3?o(t,n,s):o(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s};let lt=class extends s.w3{};lt=ct([(0,s.Ei)({components:{Profile:st}})],lt);var it=lt;const ut=(0,z.Z)(it,[["render",Ne]]);var dt=ut;function ft(e,t,n,r,a,s){const c=(0,o.up)("NewRecord");return(0,o.wg)(),(0,o.j4)(c)}const pt=e=>((0,o.dD)("data-v-f3953038"),e=e(),(0,o.Cn)(),e),mt={class:"formContainer"},vt={class:"formContent"},gt=(0,o.Uk)("New Record"),wt=(0,o.Uk)("Evidences"),ht={key:0},yt=pt((()=>(0,o._)("div",{style:{"margin-top":"8px"}},"Upload Files",-1))),_t={key:0,class:"alertGap"},kt=(0,o.Uk)("References"),Wt=(0,o.Uk)(" Select from collections "),bt={key:0,class:"alertGap"},Ct=(0,o.Uk)(" Save "),jt=(0,o.Uk)(" Cancel ");function xt(e,t,n,r,a,s){const c=(0,o.up)("a-typography-title"),l=(0,o.up)("a-row"),i=(0,o.up)("a-textarea"),u=(0,o.up)("a-alert"),d=(0,o.up)("upload-outlined"),f=(0,o.up)("a-upload"),p=(0,o.up)("Evidences"),m=(0,o.up)("a-card"),v=(0,o.up)("a-button"),g=(0,o.up)("a-modal");return(0,o.wg)(),(0,o.iD)("div",mt,[(0,o._)("div",vt,[(0,o.Wm)(l,null,{default:(0,o.w5)((()=>[(0,o.Wm)(c,{level:2},{default:(0,o.w5)((()=>[gt])),_:1})])),_:1}),(0,o.Wm)(l,null,{default:(0,o.w5)((()=>[(0,o.Wm)(i,{rows:4,onChange:t[0]||(t[0]=()=>e.alert.description=""),value:e.description,"onUpdate:value":t[1]||(t[1]=t=>e.description=t),placeholder:"Describe the record, append tags with # at the end",style:{"font-size":"large"}},null,8,["value"])])),_:1}),e.alert.description?((0,o.wg)(),(0,o.j4)(l,{key:0,class:"alertGap"},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{message:e.alert.description,type:"error"},null,8,["message"])])),_:1})):(0,o.kq)("",!0),(0,o.Wm)(l,{class:"titleGap"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{level:3},{default:(0,o.w5)((()=>[wt])),_:1})])),_:1}),(0,o.Wm)(l,{type:"flex"},{default:(0,o.w5)((()=>[(0,o._)("div",null,[(0,o.Wm)(f,{name:"evidence","file-list":e.evidences,"onUpdate:file-list":t[2]||(t[2]=t=>e.evidences=t),accept:"image/*,video/*","list-type":"picture-card",onPreview:e.handlePreview,customRequest:e.uploadCustomRequest,maxCount:5,multiple:"",onChange:t[3]||(t[3]=()=>e.alert.evidences="")},{default:(0,o.w5)((()=>[e.evidences.length<5?((0,o.wg)(),(0,o.iD)("div",ht,[(0,o.Wm)(d),yt])):(0,o.kq)("",!0)])),_:1},8,["file-list","onPreview","customRequest"])]),e.alert.evidences?((0,o.wg)(),(0,o.iD)("div",_t,[(0,o.Wm)(u,{message:e.alert.evidences,type:"error"},null,8,["message"])])):(0,o.kq)("",!0)])),_:1}),(0,o.Wm)(l,{class:"titleGap"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{level:3},{default:(0,o.w5)((()=>[kt])),_:1})])),_:1}),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.references,((t,n)=>((0,o.wg)(),(0,o.j4)(l,{key:n},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{style:{width:"100%","margin-top":"10px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(l,{style:{"margin-bottom":"20px"}},{default:(0,o.w5)((()=>[(0,o.Uk)(" Created by "+(0,O.zw)(t.creator.username||"Someone")+" "+(0,O.zw)(e.formatDate(t.createdAt)),1)])),_:2},1024),(0,o.Wm)(l,{style:{"margin-bottom":"20px"}},{default:(0,o.w5)((()=>[(0,o._)("span",null,(0,O.zw)(t.description),1)])),_:2},1024),(0,o.Wm)(l,null,{default:(0,o.w5)((()=>[(0,o.Wm)(p,{evidence:t.evidences},null,8,["evidence"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),(0,o.Wm)(l,{style:{"margin-top":"10px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{type:"dashed",size:"large",onClick:e.onShowCollections},{default:(0,o.w5)((()=>[Wt])),_:1},8,["onClick"])])),_:1}),(0,o.Wm)(l,{class:"titleGap",type:"flex",style:{"justify-content":"space-around"}},{default:(0,o.w5)((()=>[e.alert.save?((0,o.wg)(),(0,o.iD)("div",bt,[(0,o.Wm)(u,{message:e.alert.save,type:"error"},null,8,["message"])])):(0,o.kq)("",!0),(0,o.Wm)(v,{type:"primary",size:"large",onClick:e.onSaveRecord},{default:(0,o.w5)((()=>[Ct])),_:1},8,["onClick"]),(0,o.Wm)(v,{type:"primary",size:"large",href:"/"},{default:(0,o.w5)((()=>[jt])),_:1})])),_:1})]),(0,o.Wm)(g,{visible:e.showCollections,title:"Select record to reference",onOk:e.onAddReference,onCancel:e.onCancelReference},{default:(0,o.w5)((()=>[(0,o._)("div",{onScroll:t[4]||(t[4]=(...t)=>e.onScroll&&e.onScroll(...t)),style:{height:"calc(50vh)",overflow:"auto","background-color":"#ececec"}},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.collections,((t,n)=>((0,o.wg)(),(0,o.j4)(m,{hoverable:"selected"!==t.status,class:(0,O.C_)(t.status||"available"),key:n,onClick:()=>e.selectReference(t)},{default:(0,o.w5)((()=>[(0,o.Wm)(l,{style:{"margin-bottom":"20px"}},{default:(0,o.w5)((()=>[(0,o.Uk)(" Created by "+(0,O.zw)(t.creator.username||"Someone")+" "+(0,O.zw)(e.formatDate(t.createdAt)),1)])),_:2},1024),(0,o.Wm)(l,{style:{"margin-bottom":"20px"}},{default:(0,o.w5)((()=>[(0,o._)("span",null,(0,O.zw)(t.description),1)])),_:2},1024),(0,o.Wm)(l,null,{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.evidences,(e=>((0,o.wg)(),(0,o.j4)(p,{class:"evidence",key:e.id,preview:!0,evidence:e},null,8,["evidence"])))),128))])),_:2},1024)])),_:2},1032,["hoverable","class","onClick"])))),128))],32)])),_:1},8,["visible","onOk","onCancel"])])}n(1703);var Rt=n(9516);async function Zt(e,t){const n=await E().get(A.T+"evidence/raw",{params:{hash:t},headers:(0,H.zl)(e)});return n.data}async function Tt(e,t){const n=new FormData;n.append("evidences",t);const r=(0,H.zl)(e),o={headers:{"content-type":"multipart/form-data; boundary=----WebKitFormBoundaryqTqJIxvkWFYqvP5s",...r}},a=await E().post(A.T+"evidence/upload",n,o);return a.data.uploaded[0]}var zt=(0,o.aZ)({components:{UploadOutlined:Rt.Z,Evidences:ne},setup(){const e=(0,x.oR)();if(!(0,R.YR)(e))return;e.state.profile?.username||bn.push("init");const t=(0,u.qj)({}),n=(0,u.iH)(""),r=(0,u.iH)([]),o=(0,u.iH)([]),a=(0,u.qj)([]),s=(0,u.iH)(!1),c=e=>{"selected"==e.status?e.status="available":e.status="selected"},l=()=>{s.value=!1,a.forEach((e=>{"selected"==e.status&&(r.value.push(e),e.status="added")}))},i=(e,t)=>{e.status="available",r.value.splice(t,1)},d=()=>{s.value=!1},f=async e=>{window.open(e.url)},p=async()=>{const a={description:n.value,evidences:o.value,references:r.value},s=I(a,t);if(s.ok)try{const t=await Y(e,a);bn.push("/record/"+t.hash)}catch(c){t.save=(0,H.nt)(c)}},m=(0,u.qj)({offset:0,limit:20}),v=()=>{K(e,m).then((e=>{e.length>0&&(m.startAt||(m.startAt=e[0].collectedAt),m.offset+=e.length),e.forEach((e=>a.push(e)))}))},g=()=>{s.value=!0,0==a.length&&v()},w=({target:{scrollTop:e,clientHeight:t,scrollHeight:n}})=>{e+t>=n&&v()},h=async t=>{for(const r of o.value)if(t.file.uid==r.uid)try{const n=await(0,H.xP)(t.file),{exists:r}=await Zt(e,n);if(r)t.onSuccess({name:t.file.name,mimeType:t.file.type,raw:n},t.file);else{const n=await Tt(e,t.file);"error"in n?t.onError(new Error(n.error),n,t.file):t.onSuccess({name:t.file.name,mimeType:t.file.type,raw:n.hash},t.file)}}catch(n){t.onError(n,{},t.file)}};return{description:n,evidences:o,references:r,alert:t,collections:a,uploadCustomRequest:h,selectReference:c,onAddReference:l,onCancelReference:d,deleteReference:i,onSaveRecord:p,handlePreview:f,onShowCollections:g,showCollections:s,onScroll:w,formatDate:Q}}});const Dt=(0,z.Z)(zt,[["render",xt],["__scopeId","data-v-f3953038"]]);var Ut=Dt,Ot=function(e,t,n,r){var o,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(a<3?o(s):a>3?o(t,n,s):o(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s};let Pt=class extends s.w3{};Pt=Ot([(0,s.Ei)({components:{NewRecord:Ut}})],Pt);var Ht=Pt;const St=(0,z.Z)(Ht,[["render",ft]]);var qt=St;function Ft(e,t,n,r,a,s){const c=(0,o.up)("Record");return(0,o.wg)(),(0,o.j4)(c)}const Et={class:"formContainer"},At={class:"formContent"},It=(0,o.Uk)(" Home "),Yt=(0,o.Uk)("Description"),Mt=(0,o.Uk)("Evidences"),Bt=(0,o.Uk)("References");function Nt(e,t,n,r,a,s){const c=(0,o.up)("a-button"),l=(0,o.up)("a-row"),i=(0,o.up)("a-typography-title"),u=(0,o.up)("a-typography-text"),d=(0,o.up)("Evidences"),f=(0,o.up)("References");return(0,o.wg)(),(0,o.iD)("div",Et,[(0,o._)("div",At,[(0,o.Wm)(l,{type:"flex",justify:"center",style:{"margin-bottom":"50px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{type:"primary",size:"large",href:"/"},{default:(0,o.w5)((()=>[It])),_:1})])),_:1}),(0,o.Wm)(l,null,{default:(0,o.w5)((()=>[(0,o.Wm)(i,{level:3},{default:(0,o.w5)((()=>[Yt])),_:1})])),_:1}),(0,o.Wm)(l,null,{default:(0,o.w5)((()=>[(0,o.Wm)(u,{style:{"font-size":"20px"}},{default:(0,o.w5)((()=>[(0,o.Uk)((0,O.zw)(e.description),1)])),_:1})])),_:1}),e.evidences.length>0?((0,o.wg)(),(0,o.j4)(l,{key:0,class:"titleGap"},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{level:3},{default:(0,o.w5)((()=>[Mt])),_:1})])),_:1})):(0,o.kq)("",!0),(0,o.Wm)(l,null,{default:(0,o.w5)((()=>[(0,o.Wm)(d,{evidences:e.evidences},null,8,["evidences"])])),_:1}),e.references.length>0?((0,o.wg)(),(0,o.j4)(l,{key:1,class:"titleGap"},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{level:3},{default:(0,o.w5)((()=>[Bt])),_:1})])),_:1})):(0,o.kq)("",!0),(0,o.Wm)(f,{references:e.references},null,8,["references"])])])}var Kt=(0,o.aZ)({components:{Evidences:ne,References:le},props:{record:Object},setup(){const e=(0,x.oR)();if(!(0,R.YR)(e))return;const t=(0,r.yj)(),n=(0,u.iH)(""),a=(0,u.iH)([]),s=(0,u.iH)([]);(0,o.bv)((async()=>{const r=t.params.hash,o=await M(e,r);o?(n.value=o.description,s.value=o.evidences||[],a.value=o.references||[]):n.value="record not found"}));const c=e=>A._+"static/evidences/"+e.rawFile.hash,l=e=>"image/png"==e.mimeType||"image/jpeg"==e.mimeType||"image/jpg"==e.mimeType?"image":"video/mp4"==e.mimeType?"video":"file",i=e=>{const t=e.rawFile.size;return t?t<1024?t.toFixed(1)+"B":t<1048576?(t/1024).toFixed(1).toString()+"KB":t<1073741824?(t/1048576).toFixed(1).toString()+"MB":"> 1GB":"Unknown Size"};return{route:t,description:n,references:a,evidences:s,shortDescription:H.Z8,fileUrl:c,fileType:l,calFileSize:i,formatDate:Q}}});const Gt=(0,z.Z)(Kt,[["render",Nt],["__scopeId","data-v-18cef112"]]);var Lt=Gt,$t={name:"RecordView",components:{Record:Lt}};const Jt=(0,z.Z)($t,[["render",Ft]]);var Vt=Jt;function Qt(e,t,n,r,a,s){const c=(0,o.up)("Collections");return(0,o.wg)(),(0,o.j4)(c)}const Xt={class:"content"},en={key:0,style:{"padding-bottom":"100px"}};function tn(e,t,n,r,a,s){const c=(0,o.up)("Navigation"),l=(0,o.up)("CollectedRecords"),i=(0,o.up)("a-row");return(0,o.wg)(),(0,o.iD)("div",Xt,[(0,o.Wm)(c),e.authenticated?((0,o.wg)(),(0,o.iD)("div",en,[(0,o.Wm)(i,{justify:"center"},{default:(0,o.w5)((()=>[(0,o.Wm)(l)])),_:1})])):(0,o.kq)("",!0)])}function nn(e,t,n,r,a,s){const c=(0,o.up)("CollectedRecord"),l=(0,o.up)("a-row"),i=(0,o.up)("a-spin");return(0,o.wg)(),(0,o.iD)(o.HY,null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.records,((t,n)=>((0,o.wg)(),(0,o.j4)(l,{key:t.hash,type:"flex",justify:"center",class:"preview"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{record:t,index:n,onToggleCollection:e.toggleCollection},null,8,["record","index","onToggleCollection"])])),_:2},1024)))),128)),(0,o.Wm)(l,null,{default:(0,o.w5)((()=>[e.loading?((0,o.wg)(),(0,o.j4)(i,{key:0})):(0,o.kq)("",!0)])),_:1}),e.errMsg?((0,o.wg)(),(0,o.j4)(l,{key:0,style:{"margin-top":"100px"}},{default:(0,o.w5)((()=>[(0,o._)("span",null,(0,O.zw)(e.errMsg),1)])),_:1})):(0,o.kq)("",!0)],64)}const rn=["href"];function on(e,t,n,r,a,s){const c=(0,o.up)("a-avatar"),l=(0,o.up)("a-row"),i=(0,o.up)("a-col"),u=(0,o.up)("DeleteOutlined"),d=(0,o.up)("a-button"),f=(0,o.up)("Evidences"),p=(0,o.up)("References"),m=(0,o.up)("a-divider");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(l,{class:"container"},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{span:4},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{size:50,class:"avatar",shape:"square"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,O.zw)(e.record.creator.username.substring(0,1).toUpperCase()),1)])),_:1}),(0,o.Wm)(l,{type:"flex",justify:"center"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,O.zw)(e.record.creator.username),1)])),_:1})])),_:1}),(0,o.Wm)(i,{span:20},{default:(0,o.w5)((()=>[(0,o.Wm)(l,{justify:"space-between"},{default:(0,o.w5)((()=>[(0,o.Wm)(i,null,{default:(0,o.w5)((()=>[(0,o._)("a",{href:e.recordUrl},[(0,o._)("span",null,(0,O.zw)(e.record.description),1)],8,rn)])),_:1}),(0,o.Wm)(i,null,{default:(0,o.w5)((()=>[(0,o.Wm)(d,{type:"text",onClick:e.onCollect},{icon:(0,o.w5)((()=>[(0,o.Wm)(u,{twoToneColor:"#eb2f96"})])),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.Wm)(l,null,{default:(0,o.w5)((()=>[(0,o.Wm)(f,{evidences:e.record.evidences},null,8,["evidences"])])),_:1}),(0,o.Wm)(p,{references:e.record.references},null,8,["references"]),(0,o.Wm)(l,{type:"flex",justify:"space-between",align:"middle",style:{"margin-top":"10px",color:"gray","font-size":"12px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(i,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,O.zw)(e.formatDate(e.record.createdAt)),1)])),_:1})])),_:1})])),_:1})])),_:1}),(0,o.Wm)(m,{class:"container"})],64)}var an=n(681),sn=(0,o.aZ)({components:{Evidences:ne,References:le,DeleteOutlined:an.Z},props:{record:Object,index:Number},setup(e,{emit:t}){const n=(0,x.oR)(),r=(0,o.Fl)((()=>"/record/"+e.record.hash)),a=()=>{L(n,e.record.hash).then((()=>{t("toggleCollection",{index:e.index})}))},s=(0,o.Fl)((()=>{const t=n.state.user.id;return e.record.collectors.some((e=>e.userId==t))}));return{formatDate:Q,recordUrl:r,isCollected:s,onCollect:a}}});const cn=(0,z.Z)(sn,[["render",on],["__scopeId","data-v-33385066"]]);var ln=cn,un=(0,o.aZ)({components:{CollectedRecord:ln},setup(){const e=(0,x.oR)();let t=(0,u.iH)(!1),n=(0,u.iH)([]),r=(0,u.iH)("");const a=(0,u.qj)({limit:20,offset:0});(0,o.wF)((()=>{n.value=[],t.value=!0,K(e,a).then((e=>{e.forEach((e=>{n.value.push(e)})),a.limit+=e.length,e.length>0&&(a.startAt=a.startAt||e[0].createdAt)})).catch((e=>{r.value="Failed to fetch events from server, "+(0,H.nt)(e)})).finally((()=>{t.value=!1}))}));const s=e=>{n.value.splice(e.index,1)};return{loading:t,errMsg:r,records:n,toggleCollection:s}}});const dn=(0,z.Z)(un,[["render",nn],["__scopeId","data-v-2001cb8e"]]);var fn=dn,pn=(0,o.aZ)({components:{Navigation:U,CollectedRecords:fn},setup(){const e=(0,x.oR)(),t=(0,u.iH)(!1);if((0,R.YR)(e))return t.value=!0,{authenticated:t}}});const mn=(0,z.Z)(pn,[["render",tn],["__scopeId","data-v-6e0e54ca"]]);var vn=mn,gn=function(e,t,n,r){var o,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(a<3?o(s):a>3?o(t,n,s):o(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s};let wn=class extends s.w3{};wn=gn([(0,s.Ei)({components:{Collections:vn}})],wn);var hn=wn;const yn=(0,z.Z)(hn,[["render",Qt]]);var _n=yn;const kn=[{path:"/",name:"discover",component:Be},{path:"/home",name:"home",component:be},{path:"/profile",name:"profile",component:dt},{path:"/init",name:"initProfile",component:()=>n.e(2).then(n.bind(n,2002))},{path:"/register",name:"register",component:()=>n.e(63).then(n.bind(n,3063))},{path:"/login",name:"login",component:()=>n.e(133).then(n.bind(n,8133))},{path:"/verify",name:"verify",component:()=>n.e(77).then(n.bind(n,2077))},{path:"/record/new",name:"newRecord",component:qt},{path:"/record/:hash",name:"record",component:Vt},{path:"/collections",name:"Collections",component:_n}],Wn=(0,r.p7)({history:(0,r.PO)("/"),routes:kn});var bn=Wn},6678:function(e,t,n){"use strict";n.d(t,{OA:function(){return m},YR:function(){return w},kS:function(){return g},qD:function(){return v},sB:function(){return f},z2:function(){return p}});var r=n(6265),o=n.n(r),a=n(252),s=n(4535),c=n(9553),l=n(5602);function i(e){return/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(e)}function u(e){return/^[0-9A-Za-z]{6}$/.test(e)}function d(){return Math.floor((new Date).getTime()/1e3)}function f(e){const t=d()-e;return`The passcode was sent ${t} seconds ago, you can retry in ${60-t} senconds`}async function p(e,t,n){if(!i(t))return"please input a valid email address";const r="register",u=a.ZP.loading({content:"registering...",key:r}),d=l.T+"auth/register";let f="";try{await o().post(d,{email:t,invitationCode:n}),e.commit("setUser",{email:t}),u();const c=a.ZP.success({content:"saved, redirecting to login page...",key:r,duration:1});setTimeout((()=>{c(),s.Z.push("/login")}),1e3)}catch(p){u(),f=(0,c.nt)(p)}return f}async function m(e,t){if(!i(t))return"please input a valid email address";const n="sendOTP",r=a.ZP.loading({content:"sending passcode...",key:n}),s=l.T+"auth/passcode";let u="";try{const n=await o().post(s,{email:t});n.data.existingOTP&&(u=f(n.data.sentAt)),e.commit("setUser",{email:t,otp:{sentAt:n.data.sentAt,existing:n.data.existingOTP}})}catch(d){u=(0,c.nt)(d)}return r(),u}async function v(e,t){if(!u(t))return"please input a valid passcode";const n="verifyOTP",r=a.ZP.loading({content:"logging in...",key:n}),s=l.T+"auth/verify";let i="";try{const n=await o().post(s,{email:e.state.user.email,passcode:t});e.commit("setUser",{id:n.data.id,email:n.data.email,jwt:n.data.jwt}),e.commit("setProfile",{username:n.data.username})}catch(d){i=(0,c.nt)(d)}return r(),i}async function g(e){const t=l.T+"logout";try{await o().post(t,{},{headers:(0,c.zl)(e)})}catch(n){console.log("logout error: "),console.log(n)}e.commit("setUser",{}),s.Z.push("/login")}function w(e){return e.state.user?.jwt?!!e.state.profile?.username||(s.Z.push("init"),!1):(e.commit("clear"),s.Z.push("/login"),!1)}},6772:function(e,t,n){"use strict";n.d(t,{_S:function(){return d},mI:function(){return u},x6:function(){return f}});var r=n(6265),o=n.n(r),a=n(252),s=n(4535),c=n(9553),l=n(5602);function i(e){return/^(?!\d)(?!.*-.*-)(?!.*-$)(?!-)[a-zA-Z0-9-]{3,20}$/.test(e)}async function u(e,t){if(!i(t.username))return"please input a valid username";const n="initProfile",r=a.ZP.loading({content:"saving...",key:n}),u=l.T+"profile/init";let d="";try{await o().post(u,t,{headers:(0,c.zl)(e)});e.commit("setProfile",t);const r=a.ZP.success({content:"saved, redirecting to home...",key:n});setTimeout((()=>{r(),s.Z.push("/")}),1e3)}catch(f){r(),d=(0,c.nt)(f)}return d}async function d(e,t){i(t)||a.ZP.error("please input a valid username");const n="setUsername";a.ZP.loading({content:"saving...",key:n,duration:0});const r=l.T+"profile/setusername";try{await o().post(r,{username:t},{headers:(0,c.zl)(e)});return e.commit("updateProfile",{username:t}),a.ZP.success({content:"saved",key:n}),!0}catch(s){return a.ZP.error({content:"failed to save username, "+(0,c.nt)(s),key:n}),!1}}async function f(e){const t=l.T+"invitationCode";try{const n=await o().post(t,{},{headers:(0,c.zl)(e)});return n.data}catch(n){return{message:(0,c.nt)(n)}}}},9553:function(e,t,n){"use strict";n.d(t,{Z8:function(){return l},nt:function(){return s},xP:function(){return c},zl:function(){return a}});var r=n(8082),o=n.n(r);function a(e){return{"x-access-token":e.state.user.jwt.accessToken}}function s(e,t){return e.response?.data?.message||e.response?.message||t||"unknown error"}async function c(e){return new Promise(((t,n)=>{const r=o().algo.SHA256.create(),a=new FileReader;a.onload=function(){const e=a.result,n=o().lib.WordArray.create(e);r.update(n),t(r.finalize().toString())},a.readAsArrayBuffer(e)}))}function l(e){return e.length>100?e.substring(0,100)+"...":e}},8387:function(e,t,n){"use strict";n.d(t,{Jy:function(){return a},h:function(){return c},oR:function(){return l}});var r=n(7139),o=n(5103);const a=Symbol(),s=new o.ZP({storage:window.localStorage}),c=(0,r.MT)({state(){return{}},mutations:{clear(e){e.user=void 0,e.profile=void 0},setUser(e,t){e.user=t},setProfile(e,t){e.profile=t},updateProfile(e,t){Object.assign(e.profile,t)}},plugins:[s.plugin]});function l(){return(0,r.oR)(a)}},6949:function(e,t,n){"use strict";e.exports=n.p+"img/logo.0bfdc436.png"},2480:function(){}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,n),a.exports}n.m=e,function(){var e=[];n.O=function(t,r,o,a){if(!r){var s=1/0;for(u=0;u<e.length;u++){r=e[u][0],o=e[u][1],a=e[u][2];for(var c=!0,l=0;l<r.length;l++)(!1&a||s>=a)&&Object.keys(n.O).every((function(e){return n.O[e](r[l])}))?r.splice(l--,1):(c=!1,a<s&&(s=a));if(c){e.splice(u--,1);var i=o();void 0!==i&&(t=i)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[r,o,a]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,r){return n.f[r](e,t),t}),[]))}}(),function(){n.u=function(e){return"js/"+e+"."+{2:"e8f954bb",63:"5bf8c564",77:"d8ba07f3",133:"e82e67ff"}[e]+".js"}}(),function(){n.miniCssF=function(e){}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="webapp:";n.l=function(r,o,a,s){if(e[r])e[r].push(o);else{var c,l;if(void 0!==a)for(var i=document.getElementsByTagName("script"),u=0;u<i.length;u++){var d=i[u];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+a){c=d;break}}c||(l=!0,c=document.createElement("script"),c.charset="utf-8",c.timeout=120,n.nc&&c.setAttribute("nonce",n.nc),c.setAttribute("data-webpack",t+a),c.src=r),e[r]=[o];var f=function(t,n){c.onerror=c.onload=null,clearTimeout(p);var o=e[r];if(delete e[r],c.parentNode&&c.parentNode.removeChild(c),o&&o.forEach((function(e){return e(n)})),t)return t(n)},p=setTimeout(f.bind(null,void 0,{type:"timeout",target:c}),12e4);c.onerror=f.bind(null,c.onerror),c.onload=f.bind(null,c.onload),l&&document.head.appendChild(c)}}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.p="/"}(),function(){var e={143:0};n.f.j=function(t,r){var o=n.o(e,t)?e[t]:void 0;if(0!==o)if(o)r.push(o[2]);else{var a=new Promise((function(n,r){o=e[t]=[n,r]}));r.push(o[2]=a);var s=n.p+n.u(t),c=new Error,l=function(r){if(n.o(e,t)&&(o=e[t],0!==o&&(e[t]=void 0),o)){var a=r&&("load"===r.type?"missing":r.type),s=r&&r.target&&r.target.src;c.message="Loading chunk "+t+" failed.\n("+a+": "+s+")",c.name="ChunkLoadError",c.type=a,c.request=s,o[1](c)}};n.l(s,l,"chunk-"+t,t)}},n.O.j=function(t){return 0===e[t]};var t=function(t,r){var o,a,s=r[0],c=r[1],l=r[2],i=0;if(s.some((function(t){return 0!==e[t]}))){for(o in c)n.o(c,o)&&(n.m[o]=c[o]);if(l)var u=l(n)}for(t&&t(r);i<s.length;i++)a=s[i],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(u)},r=self["webpackChunkwebapp"]=self["webpackChunkwebapp"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=n.O(void 0,[998],(function(){return n(2776)}));r=n.O(r)})();
//# sourceMappingURL=app.1b2fd667.js.map